## 내 머리가 탈모인가요? (Am I Hair Loss?)

탈모 단계 알아보기 프로젝트

<br>

### 원본 데이터 세트 살펴 보기

* [AI Hub "유형별 두피 이미지"](https://aihub.or.kr/aihubdata/data/view.do?currMenu=115&topMenu=100&aihubDataSe=data&dataSetSn=216)
<p> ❕ 두피질환 데이터 중 탈모 데이터만 사용</p>
<p>- img 형식의 원천데이터 & json 형식의 라벨링 데이터</p>
<pre>
/유형별 두피 이미지
  /1.Training
    /[라벨]탈모_0.양호.zip
     [라벨]탈모_1.경증.zip
     [라벨]탈모_2.중등도.zip
     [라벨]탈모_3.중증.zip
    /[원천]탈모_0.양호.zip
     [원천]탈모_1.경증.zip
     [원천]탈모_2.중등도.zip
     [원천]탈모_3.중증.zip
  /2.Validation
    /[라벨]탈모_0.양호.zip
     [라벨]탈모_1.경증.zip
     [라벨]탈모_2.중등도.zip
     [라벨]탈모_3.중증.zip
    /[원천]탈모_0.양호.zip
     [원천]탈모_1.경증.zip
     [원천]탈모_2.중등도.zip
     [원천]탈모_3.중증.zip
</pre>

<br>

💦 과정

데이터 전처리 -> 딥러닝 모델링 -> 메인화면 구현

<br>

📃기간은? 2024.09.09.~2024.09.20.

<br>

🤷‍♂️인원은? 개인 프로젝트

<br>

💫 목표는?

1. 딥러닝 모델링의 이해 및 구현
2. Flask를 통한 웹 애플리케이션 구동

<br>

##### <실제 화면>
![딥러닝1](https://github.com/user-attachments/assets/bac519d4-6fc2-470b-8eb8-fd649d41c992)
![딥러닝2](https://github.com/user-attachments/assets/e429a578-9153-43c9-b79d-cf9748060386)

<br>

# 회고 및 기록

프로젝트를 진행하면서 여러 가지 문제에 부딪혔다. 개중 가장 난제였던
1. 용량의 문제
2. 속도의 문제

에 대해 짧게 이야기하자면...


#### 1. 용량의 문제

딥러닝 프로젝트를 진행하기 위해 AI Hub에서 데이터를 조사했다. 문제는 데이터의 용량이 너무 거대하다는 것...
그래서 두피 유형별 이미지 데이터에서 탈모 데이터만 사용하는 것으로 결정. 여기까지는 아이디어에 관한 내용이니 그렇다 쳐도


#### 2. 속도의 문제

GPU가 없기 때문에 데이터를 학습시키는 데 엄청난 시간이 들었다.

한 번은 아예 모델링 중 멈춰 실패했고,
두 번째 도전했을 때는 약 9시간 가량 걸렸다. (CPU 100% 사용함...)

코드를 보면 알겠지만 tensorflow keras를 사용했다.

일단 내가 코드를 작성하고 실행한 과정을 설명하자면 아래와 같다.

#### preprocess.py(데이터 전처리 과정) -> model.py(모델링 과정) -> main.py(웹 애플리케이션 구동)
<br>
코드 실행은 전부 anaconda prompt에서 진행했다.

<br>가상환경 activate 후 (conda activate [가상환경이름])

#### python prerprocess.py -> python model.py -> python main.py
<br> 

#### 1. python preprocess.py

데이터 전처리 과정에서 자잘한 에러가 계속 발생했다. 기억 남는 건 데이터 경로에 관한 에러이다.

원인은 다운받은 데이터의 이름이 한글로 되어 있기 때문이었는데(추측), 결국 영어로 다 수정하여 해결하는 방법을 사용했다.

그렇게 하니까 되긴 되더라...


#### 2. python model.py

나는 구글 코랩을 사용하지 않았는데 GPU가 있는 것도 아니었다. 왜 그랬냐고 물어보면... 할 말이 없음. 그냥. 그냥 한 거임...

그래서 9시간 가까이 걸렸고, 사실 실패할 줄 알았는데 됐다.

근데 그거 아시죠... 되면 왜 됐지??? 하는 혼란에 빠지는 거


### ❗❗❗ 그래서
#### 3. evaluation.py가 등장하다.

아니나 다를까 main.py 실행하는데 오류나는거임.ㅋㅋㅋㅋㅋㅋㅋㅋ

오류가 index페이지는 일단 뜨긴 뜸. 근데 사진 넣고 검사했을 때 ERRRO!!!

처음에는 404오류였나?...  이건 Flask가 templates 폴더 내에서 index.html을 찾는데 내가 index.html을 templates 아래에 위치하지 않았었다.
결국 templates 아래로 index.html 이동시키고 나서 해결.

그랬다가 다음에는 Key Error. 그리고 다음에는 그냥 error 안내 메세지만 보였던듯.

모델링이 잘못된 줄 알고 드롭할까 진지하게 고민했다. 또다시 9시간을 신경쓰고 싶지 않았기 때문😂

일단 침착하고 학습시킨 모델을 평가해보기로 했다. 이것 또한 많은 시행착오 끝에 모델 평가에 성공했는데

어? 이건 왜 됨?

이쯤 되면 그냥 될 때까지 들이받는거다.


#### 4. python main.py

predicted_class 값이 class_labels 딕셔너리의 키와 일치하지 않는 문제가 발생했다.

응~ 익숙해~

디버깅 지옥을 지나 어찌저찌 완성(?)

<br>

### 아쉬운 점

모델링에 문제가 있는 것 같긴 하다. 양호한 사진을 넣어도 경증으로 나오니... 양호가 나오긴 했는데 딱 한 번이었다.

사실 딥러닝을 잘 알고 시작한 게 아니라서 더 아쉬움이 남는 프로젝트였다. 언젠가 이 프로젝트를 보완할 날이 오길 바란다.
